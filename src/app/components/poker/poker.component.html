<div class="flex h-full w-full flex-col items-center">
  <div class="mt-4 flex flex-col items-center justify-between sm:w-[550px]">
    <mat-form-field class="w-40">
      <mat-label>Pseudonyme</mat-label>
      <input matInput [formControl]="nameControl" />
    </mat-form-field>
    <div class="hidden w-full items-center justify-between sm:flex">
      <button
        *ngFor="let effect of EFFECTS"
        [disabled]="isUserEffectPlaying"
        (click)="sendUserEffect(effect.name)"
        class="mb-6 text-lg"
        mat-raised-button
        color="warn">
        {{ effect.message }}
      </button>
    </div>

    <div class="sm:hidden">
      <mat-form-field>
        <mat-label>J'ai envie de dire...</mat-label>
        <mat-select [formControl]="userEffectControl">
          <mat-option *ngFor="let effect of EFFECTS" [value]="effect.name">
            {{ effect.message }}
          </mat-option>
        </mat-select>
      </mat-form-field>
    </div>
  </div>
  <div class="flex flex-wrap justify-center sm:my-4">
    <button (click)="sendVote(card.value)" class="mx-2 my-2 text-xl" *ngFor="let card of VOTE_CARDS" mat-raised-button color="primary">
      {{ card.value }}
    </button>
  </div>
  <div class="mt-5">
    <table #dataTable mat-table [dataSource]="dataSource" class="mat-elevation-z8 mx-auto">
      <!-- Name Column -->
      <ng-container matColumnDef="name">
        <th mat-header-cell *matHeaderCellDef>Pseudonyme</th>
        <td mat-cell *matCellDef="let element" class="relative">
          <p class="mb-0 overflow-hidden overflow-ellipsis whitespace-nowrap">{{ element.name }}</p>
          <speech-bubble *ngIf="element.effect" [effect]="element.effect" class="absolute -top-[90px] left-[50%] h-[100px] w-[100px]"></speech-bubble>
        </td>
      </ng-container>
      <!-- Vote Column -->
      <ng-container matColumnDef="vote">
        <th mat-header-cell *matHeaderCellDef>Vote</th>
        <td mat-cell *matCellDef="let element">
          {{ element.vote ? (roomState.isHidden ? '??' : element.vote.value) : '' }}
        </td>
      </ng-container>
      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
    </table>
  </div>
  <div class="mt-10 flex w-56 justify-between sm:w-60">
    <button (click)="toggleHide()" class="my-2 text-lg" mat-raised-button color="accent">
      {{ roomState.isHidden ? 'Afficher' : 'Masquer' }}
    </button>
    <button (click)="resetVotes()" class="my-2 text-lg" mat-raised-button color="accent">Reset</button>
  </div>
  <div class="h-9 sm:hidden">
    <button (click)="joinRoom()" class="mt-6 text-lg" mat-raised-button color="accent">Rejoindre une room</button>
  </div>
</div>
<canvas id="myCanvas" class="pointer-events-none fixed left-0 top-0 z-10 h-full w-full"></canvas>
<audio *ngIf="roomEffect === ROOM_EFFECT.Fanfare" class="hidden" [volume]="0.3" autoplay src="../../../assets/sounds/fanfare.mp3"></audio>
